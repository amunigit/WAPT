import java.util.Observable;
import java.util.Observer;

import ConfigClasses.*;

public class VirtualClientGenerator implements Observer {

	private VirtualClient[] virtualClientThreads;
	private long[] responseTimeAvgArray;
	private long[] responseTimeMaxArray;
	private long[] responseTimeMinArray;
	private HTMLConfig config;
	private boolean runComplete = false;
	
	public VirtualClientGenerator(int noOfClients, HTMLConfig con) {
		virtualClientThreads = new VirtualClient[noOfClients];
		responseTimeArray = new long[virtualClientThreads.length];
		config = con;
	}
	
	public void runGenerator(){
		for(int i = 0; i < virtualClientThreads.length; i++){
			virtualClientThreads[i] = new VirtualClient(i, config.getTargetPath(), config.getTestDuration(), config.getRequestType(), config.getUrlParam(), this);
			virtualClientThreads[i].start();
			responseTimeArray[i] = 0;
		}
		try {
			Thread.sleep(config.getTestDuration() + 5000);
			for(int i = 0; i < virtualClientThreads.length; i++){
				responseTimeArray[i] = virtualClientThreads[i].getResponseTime();
			}
			System.out.println("Run completed...");
			runComplete = true;
		} catch (InterruptedException e) {
		}
	}
	
	public boolean isRunComplete(){
		return runComplete;
	}

	@Override
	public synchronized void update(Observable arg0, Object arg1) {
		System.out.println("Updated");
	}
	

}
